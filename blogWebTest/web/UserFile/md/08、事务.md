# 8、事务

------



# 1、基本介绍

## 1.1、概念

如果一个包含多个步骤的业务操作被事务管理，那这些操作要么同时成功，要么同时失败

## 1.2、操作

1. 开启事务：start  transaction
2. 回滚：rollback
3. 提交：commit

MySQL数据库中事务默认自动提交

​	一条DML(增删改)语句hi自动提交一次事务

# 2、四大特征

1、原子性：是不可分隔的最小操作单位，要么同时成功，要么同时失败

2、持久性：提交或回滚后，数据库会持久化保存数据

3、隔离性：多个事务之间相互独立

4、一致性：事务操作前后，数据总量不变

# 3、隔离级别

## 3.1、概念

多个事务之间，相互独立。但是如果多个事务操作同一批数据，则会引发一些问题，设置不同的隔离级别可以解决

## 3.2、问题

**1、脏读**

一个事务读取到另一个事务中没有提交的数据

**2、不可重复读**

在用一个事务中，两次读取的数据不一样

**3、幻读**

一个事务操作数据表中所有的记录，另一个事务添加了一条数据，则第一个事务查询不到自己的修改

## 3.3、隔离级别

**1、read  uncommitted**

读未提交，三个问题都会产生

**2、read  committed**

读已提交，不会产生脏读

**3、repetable  read**

可重复读，会产生幻读，MySQL默认

**4、serializable**

串行化，不会产生问题

**隔离级别从小到大安全性越来越高，但效率越来越低**

**查询与设置隔离级别**

查询

```sql
select @@tx_isolation;
```

设置

```sql
set global transaction isolation level 级别字符串;
```

